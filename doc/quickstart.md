# Quickstart

This guide is intended to provide quick instructions on how to run the analysis.

## Set the root folder

The files architecture is mainly described [in the focus](https://github.com/LaboJeanPerrin/NeuroTools/blob/master/Matlab/%2BNT/%40Focus/architecture.m). To start an analysis, you have to provide the root path with the following folders.

    Root
    ├── Data
    │   ├── 2018-01-11
    │   │   ├── Run 01
    │   │   ├── Run 02
    │   ├── ...
    │   └── 2018-03-19
    │       └── Run 02
    └── Programs
        ├── easyRLS
        └── NeuroTools

To prevent you from installing the code several times for several projects, you can create a symbolic link to the standard location of programs.

	ln -s /home/ljp/Programs
Or in windows

	mklink -D Programs C:\\Science\Programs

## Prepare the data

An empty run folder should look like this.

    Run 03
    ├── Images
    │   ├── rec00001.dcimg
    │   └── rec00001.mat
    ├── Parameters.txt
    └── Stimulus.txt

With the 'Parameters.txt' generated by the Lightsheet program. The mat file aside the dcimg contains informations about the dcimg. Alternatively, you can put a tif image extracted from this dcimg and the program will automatically extract metadata from it.

As a preview, after running the analysis, you will have something like this.

    Run 03
    ├── Analysis
    │   ├── Background
    │   ├── Baseline
    │   ├── corrected.stack
    │   ├── DFF
    │   ├── Drift
    │   ├── graystack.stack
    │   ├── Mask
    │   ├── PhaseMap
    │   └── Segmentation
    ├── Config.mat
    ├── Images
    │   ├── dcimg.dcimg
    │   └── dcimg.mat
    ├── Parameters.txt
    └── Stimulus.txt

## Edit a template and create the focus

The file 'TEMPLATE.mat' gives you a template to configure the focus. *Do not edit it*, instead, copy it and modify it locally with a personalised name (ex Template_Hugo.m).

Once you have your own template, run the function 

	addPrograms('/home/ljp/');

with the root containing your 'Programs' folder, and it will automatically add the code to the Matlab path, and load the caTools library, on windows as on ubuntu.

Then you can change the following parameters according to your needs

    root = '/home/ljp/Science/Projects/RLS/';
    study = '';
    date = '0000-00-00';
    run = 0;

and create the focus with

    F = NT.Focus(root, study, date, run);

The focus is your golden thread for data analysis, it knows everything about the data and the data architecture. It's the first argument of most of the functions.

To do the analysis, you need to load certain parameters in the focus

    Analysis.Layers = 3:20;         % Layers to analyse
    Analysis.RefLayers = 6:6;       % reference layers for drift correction
    Analysis.RefIndex = 10;         % index of the reference stack for drift correction
    Analysis.RefStack = '';         % external reference stack if exists

    Analysis.BaselineWindow = 50;           % time in seconds of the baseline window
    Analysis.DriftBox = [ 53 566 45 914 ];  % bounding box for drift correction
    Analysis.Lineage = 'Cytoplasmic';       % possible values : 'Nuclear', 'Cytoplasmic'
    Analysis.StimulusFrequency = 0.2;       % frequency of stimulus (Hz) for phasemap computation

    F.Analysis = Analysis;

After this you can run step by step the 'main.m' file to understand how the analysis works and view the output step by step or you can run a workflow by looking the following.

### Main script
The main script gives you a list of all the functions and all the viewers.

TODO: complete this section

### Workflow
See 'sample analysis' and 'sample workflow' in the template to have a model to run the workflow.